# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–º—É —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

## –û–±–∑–æ—Ä

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç—É –±–æ—Ç–∞ **Telegram Signal Translator** –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö end-to-end: –æ—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–∏–≥–Ω–∞–ª–∞ –≤ –∏—Å—Ö–æ–¥–Ω—É—é –≥—Ä—É–ø–ø—É –¥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–µ—Ä–µ–≤–æ–¥–∞ –≤ —Ü–µ–ª–µ–≤–æ–π –≥—Ä—É–ø–ø–µ.

### –ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–∏–≥–Ω–∞–ª–æ–≤:

1. **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–æ–≤** - –ë–æ—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è —Å —Ç–µ–≥–æ–º `#–ò–¥–µ—è` –≤ SOURCE_GROUP
2. **–ü–∞—Ä—Å–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö** - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (–ø–∞—Ä–∞, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç—ã, —Å—Ç–æ–ø-–ª–æ—Å—Å)
3. **–ü–µ—Ä–µ–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞** - –ü–µ—Ä–µ–≤–æ–¥ —Ä—É—Å—Å–∫–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π —á–µ—Ä–µ–∑ Gemini API
4. **OCR –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π** - –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–∞—Ö –∏ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞—Ö
5. **–ü—É–±–ª–∏–∫–∞—Ü–∏—è** - –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞ –≤ TARGET_GROUP —á–µ—Ä–µ–∑ –∞–∫–∫–∞—É–Ω—Ç Publisher
6. **–¢—Ä–µ–¥–∏–Ω–≥ —Å–æ–æ–±—â–µ–Ω–∏–π** - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ü–µ–ø–æ—á–µ–∫ –æ—Ç–≤–µ—Ç–æ–≤ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                  INTEGRATION TESTING FLOW                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–æ–∫–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
   generate_mock_images.py
        ‚îÇ
        ‚îú‚îÄ‚Üí tests/data/mock_images/signal_ocr_1.png
        ‚îú‚îÄ‚Üí tests/data/mock_images/signal_ocr_2.png
        ‚îî‚îÄ‚Üí tests/data/mock_images/signal_ocr_3.png

2. –ó–∞–ø—É—Å–∫ Docker-—Å–µ—Ä–≤–∏—Å–æ–≤
   docker-compose up -d
        ‚îÇ
        ‚îú‚îÄ‚Üí PostgreSQL (–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)
        ‚îú‚îÄ‚Üí Redis (–∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ)
        ‚îî‚îÄ‚Üí App (–±–æ—Ç —Å Reader + Publisher)

3. –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
   run_integration_tests.py
        ‚îÇ
        ‚îú‚îÄ‚Üí –ß–∏—Ç–∞–µ—Ç: tests/data/integration_test_signals.json
        ‚îú‚îÄ‚Üí –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è: Reader –∞–∫–∫–∞—É–Ω—Ç
        ‚îî‚îÄ‚Üí –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç: 5 —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ SOURCE_GROUP

4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ—Ç–æ–º (Docker)
   app (Reader ‚Üí Processor ‚Üí Publisher)
        ‚îÇ
        ‚îú‚îÄ‚Üí –û–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç —Å–∏–≥–Ω–∞–ª—ã (#–ò–¥–µ—è)
        ‚îú‚îÄ‚Üí –ü–∞—Ä—Å–∏—Ç —Ç–æ—Ä–≥–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
        ‚îú‚îÄ‚Üí –ü–µ—Ä–µ–≤–æ–¥–∏—Ç —Ç–µ–∫—Å—Ç (Gemini API)
        ‚îú‚îÄ‚Üí –†–∞—Å–ø–æ–∑–Ω–∞–µ—Ç —Ç–µ–∫—Å—Ç –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö (OCR)
        ‚îú‚îÄ‚Üí –ü—É–±–ª–∏–∫—É–µ—Ç –≤ TARGET_GROUP
        ‚îî‚îÄ‚Üí –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –º–∞–ø–ø–∏–Ω–≥ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –ë–î

5. –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
   verify_target_group.py
        ‚îÇ
        ‚îú‚îÄ‚Üí –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è: Publisher –∞–∫–∫–∞—É–Ω—Ç
        ‚îú‚îÄ‚Üí –ß–∏—Ç–∞–µ—Ç: –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ TARGET_GROUP
        ‚îî‚îÄ‚Üí –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç: –ü–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
```

---

## –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 1. –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ

- **Docker** 20.10+ –∏ **Docker Compose** 2.0+
- **Python** 3.11+ (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤)
- **Git** (–¥–ª—è –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è)

### 2. Telegram –∞–∫–∫–∞—É–Ω—Ç—ã

–ù–µ–æ–±—Ö–æ–¥–∏–º—ã **–¥–≤–∞ —Ä–∞–∑–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–∞ Telegram**:

- **Reader (–ê–∫–∫–∞—É–Ω—Ç A)** - –ß–∏—Ç–∞–µ—Ç SOURCE_GROUP –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã
- **Publisher (–ê–∫–∫–∞—É–Ω—Ç B)** - –ü—É–±–ª–∏–∫—É–µ—Ç –ø–µ—Ä–µ–≤–æ–¥—ã –≤ TARGET_GROUP

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ –ø–æ–ª—É—á–∏—Ç–µ API credentials –Ω–∞ [my.telegram.org/apps](https://my.telegram.org/apps).

### 3. API –∫–ª—é—á–∏

- **Gemini API Key** - –ü–æ–ª—É—á–∏—Ç–µ –Ω–∞ [Google AI Studio](https://makersuite.google.com/app/apikey)
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞ —Ç–µ–∫—Å—Ç–∞ –∏ OCR –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
  - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–≤–æ—Ç–∞ API –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞ (‚â•100 –∑–∞–ø—Ä–æ—Å–æ–≤/–¥–µ–Ω—å)

### 4. Telegram –≥—Ä—É–ø–ø—ã

- **SOURCE_GROUP** - –ì—Ä—É–ø–ø–∞ –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ (Reader –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å)
- **TARGET_GROUP** - –ì—Ä—É–ø–ø–∞ –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–æ–≤ (Publisher –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å)

### 5. –§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ `.env`

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ –≤—Å–µ–º–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏:

```bash
cp .env.example .env
```

–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

```ini
# Reader Account
READER_API_ID=your_api_id
READER_API_HASH=your_api_hash
READER_PHONE=+1234567890
READER_SESSION_STRING=1BVtsOMGBu7kNWFDM...  # –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —á–µ—Ä–µ–∑ auth_local.py

# Publisher Account
PUBLISHER_API_ID=your_api_id
PUBLISHER_API_HASH=your_api_hash
PUBLISHER_PHONE=+0987654321
PUBLISHER_SESSION_STRING=1BVtsOMGBu8kNWFEM...

# –ì—Ä—É–ø–ø—ã
SOURCE_GROUP_ID=-100123456789
TARGET_GROUP_ID=-100987654321

# API
GEMINI_API_KEY=AIzaSy...

# Database
POSTGRES_PASSWORD=secure_password_here
```

**–í–ê–ñ–ù–û:** Reader –∞–∫–∫–∞—É–Ω—Ç –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ **–∑–∞–ø–∏—Å—å** –≤ SOURCE_GROUP –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π.

---

## –ö—Ä–∞—Ç–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ

### –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
git clone https://github.com/yourusername/telegram-signals-parisng.git
cd telegram-signals-parisng

# –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
python -m venv .venv
source .venv/bin/activate  # Windows: .venv\Scripts\activate

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt
```

### –®–∞–≥ 2: –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∞–∫–∫–∞—É–Ω—Ç–æ–≤

```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è session strings –¥–ª—è –æ–±–æ–∏—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤
python scripts/auth_local.py

# –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º:
# 1. –í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ Reader –∞–∫–∫–∞—É–Ω—Ç–∞ ‚Üí –ø–æ–ª—É—á–∏—Ç–µ –∫–æ–¥ –≤ Telegram
# 2. –í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ Publisher –∞–∫–∫–∞—É–Ω—Ç–∞ ‚Üí –ø–æ–ª—É—á–∏—Ç–µ –∫–æ–¥ –≤ Telegram
# 3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ session strings –≤ .env —Ñ–∞–π–ª
```

–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ [docs/AUTHENTICATION.md](AUTHENTICATION.md).

### –®–∞–≥ 3: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–æ–∫–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

```bash
# –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è OCR —Ç–µ—Å—Ç–æ–≤
python scripts/generate_mock_images.py

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# ‚úì tests/data/mock_images/signal_ocr_1.png
# ‚úì tests/data/mock_images/signal_ocr_2.png
# ‚úì tests/data/mock_images/signal_ocr_3.png
```

### –®–∞–≥ 4: –ó–∞–ø—É—Å–∫ Docker-—Å–µ—Ä–≤–∏—Å–æ–≤

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å PostgreSQL, Redis, –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
docker-compose up -d

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose ps

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –±–æ—Ç–∞
docker-compose logs -f app
```

–ë–æ—Ç –Ω–∞—á–Ω–µ—Ç —Å–ª—É—à–∞—Ç—å SOURCE_GROUP –∏ –∂–¥–∞—Ç—å —Å–∏–≥–Ω–∞–ª–æ–≤.

### –®–∞–≥ 5: –ó–∞–ø—É—Å–∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ 5 —Ç–µ—Å—Ç–æ–≤
python scripts/run_integration_tests.py --all

# –ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–µ—Å—Ç—ã
python scripts/run_integration_tests.py --test INT-001 INT-003

# Dry-run (–±–µ–∑ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π)
python scripts/run_integration_tests.py --all --dry-run
```

–°–∫—Ä–∏–ø—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç —Ç–µ—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ SOURCE_GROUP. –ë–æ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç –∏—Ö –∏ –æ–ø—É–±–ª–∏–∫—É–µ—Ç –ø–µ—Ä–µ–≤–æ–¥—ã –≤ TARGET_GROUP.

### –®–∞–≥ 6: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ TARGET_GROUP
python scripts/verify_target_group.py

# –ò–ª–∏ –∑–∞–¥–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
python scripts/verify_target_group.py --limit 20 --since 30
```

–°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏.

---

## –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### –§–∞–π–ª —Å —Ç–µ—Å—Ç–∞–º–∏: `tests/data/integration_test_signals.json`

–í—Å–µ–≥–æ 5 —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤:

| ID       | –ù–∞–∑–≤–∞–Ω–∏–µ                                  | –û–ø–∏—Å–∞–Ω–∏–µ                                                                                          | –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ | –û—Ç–≤–µ—Ç | –í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è |
|----------|-------------------------------------------|---------------------------------------------------------------------------------------------------|-------------|-------|----------------|
| INT-001  | Basic LONG signal with 2 TPs             | –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π LONG —Å–∏–≥–Ω–∞–ª —Å –ø–æ–ª–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏: –¥–∏–∞–ø–∞–∑–æ–Ω –≤—Ö–æ–¥–∞, —Å—Ç–æ–ø-–ª–æ—Å—Å, 2 —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç–∞            | –ù–µ—Ç         | –ù–µ—Ç   | 15 —Å–µ–∫         |
| INT-002  | SHORT signal with 3 TPs                  | –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π SHORT —Å–∏–≥–Ω–∞–ª —Å —Ç—Ä–µ–º—è —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç–∞–º–∏ –∏ —É–∑–∫–∏–º –¥–∏–∞–ø–∞–∑–æ–Ω–æ–º –≤—Ö–æ–¥–∞                         | –ù–µ—Ç         | –ù–µ—Ç   | 15 —Å–µ–∫         |
| INT-003  | Signal WITH IMAGE (OCR test)             | –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç + –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ (—Ç—Ä–µ–±—É–µ—Ç OCR)                               | –î–∞          | –ù–µ—Ç   | 20 —Å–µ–∫         |
| INT-004  | REPLY to INT-001 (threading test)        | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫ INT-001: –ø–µ—Ä–≤—ã–π —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç –≤–∑—è—Ç, —Å—Ç–æ–ø-–ª–æ—Å—Å –≤ –±–µ–∑—É–±—ã—Ç–∫–µ (—Ç–µ—Å—Ç —Ç—Ä–µ–¥–æ–≤)              | –ù–µ—Ç         | –î–∞    | 15 —Å–µ–∫         |
| INT-005  | Minimal signal (only pair and direction) | –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Å–∏–≥–Ω–∞–ª —Å —Ç–æ–ª—å–∫–æ –ø–∞—Ä–æ–π –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º (—Ç–µ—Å—Ç –≥–∏–±–∫–æ—Å—Ç–∏ –ø–∞—Ä—Å–µ—Ä–∞)                          | –ù–µ—Ç         | –ù–µ—Ç   | 15 —Å–µ–∫         |

### –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤

#### **INT-001: Basic LONG signal with 2 TPs**

**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–∑–æ–≤—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–∏–≥–Ω–∞–ª–∞ —Å –ø–æ–ª–Ω—ã–º–∏ —Ç–æ—Ä–≥–æ–≤—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏.

**–°–æ–æ–±—â–µ–Ω–∏–µ:**
```
#–∏–¥–µ—è BTC/USDT 4H üìà

–¢–æ—Ä–≥–æ–≤–∞—è –∏–¥–µ—è –Ω–∞ –õ–û–ù–ì –ø–æ –±–∏—Ç–∫–æ–∏–Ω—É

–í—Ö–æ–¥: 62500 - 63000
–°—Ç–æ–ø: 61500
–¢–µ–π–∫ 1: 64500
–¢–µ–π–∫ 2: 66000

–†–∏—Å–∫: 2%

‚ö†Ô∏è –í—Ö–æ–¥–∏–º —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏ –æ–±—ä–µ–º–æ–≤
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ü–∞—Ä—Å–∏–Ω–≥: `BTC/USDT`, `LONG`, `4H`, entry `62500-63000`, SL `61500`, TP1 `64500`, TP2 `66000`, risk `2%`
- –ü–µ—Ä–µ–≤–æ–¥ —Å–æ–¥–µ—Ä–∂–∏—Ç: "Trading idea", "BTC/USDT", "LONG", "Entry", "Stop", "Take"
- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ –≤ TARGET_GROUP –∑–∞ <15 —Å–µ–∫

---

#### **INT-002: SHORT signal with 3 TPs**

**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É SHORT —Å–∏–≥–Ω–∞–ª–∞ —Å —Ç—Ä–µ–º—è —É—Ä–æ–≤–Ω—è–º–∏ —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç–∞.

**–°–æ–æ–±—â–µ–Ω–∏–µ:**
```
#–ò–î–ï–Ø ETH/USDT 1H üìâ

üî¥ –®–û–†–¢ –ø–æ —ç—Ñ–∏—Ä–∏—É–º—É

–ó–æ–Ω–∞ –≤—Ö–æ–¥–∞: 2480 - 2520 üí∞
–°—Ç–æ–ø –ª–æ—Å—Å: 2570

–¶–µ–ª–∏:
–¢–µ–π–∫ 1: 2400 üéØ
–¢–µ–π–∫ 2: 2350 üéØ
–¢–µ–π–∫ 3: 2280 üéØ

–†–∏—Å–∫ 1.5% –æ—Ç –¥–µ–ø–æ–∑–∏—Ç–∞

üìä –°–∏–≥–Ω–∞–ª –∞–∫—Ç—É–∞–ª–µ–Ω –ø—Ä–∏ –ø—Ä–æ–±–æ–µ —É—Ä–æ–≤–Ω—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏
‚è∞ –¢–∞–π–º—Ñ—Ä–µ–π–º: 1 —á–∞—Å
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ü–∞—Ä—Å–∏–Ω–≥: `ETH/USDT`, `SHORT`, `1H`, entry `2480-2520`, SL `2570`, TP1 `2400`, TP2 `2350`, TP3 `2280`, risk `1.5%`
- –ü–µ—Ä–µ–≤–æ–¥ —Å–æ–¥–µ—Ä–∂–∏—Ç: "Trading idea", "ETH/USDT", "SHORT", "Entry zone", "Stop loss", "Take profit"
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ —Ç—Ä–µ—Ö —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç–æ–≤

---

#### **INT-003: Signal WITH IMAGE (OCR test)**

**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å OCR-—Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –Ω–∞ —Ç–æ—Ä–≥–æ–≤—ã—Ö –≥—Ä–∞—Ñ–∏–∫–∞—Ö.

**–°–æ–æ–±—â–µ–Ω–∏–µ:**
```
#–∏–¥–µ—è SOL/USDT 15M

üöÄ –°–º–æ—Ç—Ä–∏–º –õ–û–ù–ì –ø–æ –°–æ–ª—è–Ω–µ

–î–µ—Ç–∞–ª–∏ –Ω–∞ —Å–∫—Ä–∏–Ω–µ üëá

‚ö°Ô∏è –ë—ã—Å—Ç—Ä–∞—è —Å–¥–µ–ª–∫–∞, —Å–ª–µ–¥–∏–º –∑–∞ –æ–±—ä–µ–º–∞–º–∏!
```

**–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:** `tests/data/mock_images/signal_ocr_1.png`

–°–æ–¥–µ—Ä–∂–∏—Ç:
- Exchange: BYBIT
- Pair: SOLUSDT
- Direction: Long 20x
- Entry: 148.50
- TP: 155.00
- SL: 145.00
- ROI: +4.38%
- Status: "–ü–æ–∑–∏—Ü–∏—è –∞–∫—Ç–∏–≤–Ω–∞" / "Position Active"

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –¢–µ–∫—Å—Ç –ø–µ—Ä–µ–≤–µ–¥–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- OCR –∏–∑–≤–ª–µ–∫ –¥–∞–Ω–Ω—ã–µ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: "SOLUSDT", "Entry", "Stop", "Target"
- –ü–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç OCR –¥–∞–Ω–Ω—ã–µ
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–æ –∫ —Å–æ–æ–±—â–µ–Ω–∏—é –≤ TARGET_GROUP

---

#### **INT-004: REPLY to INT-001 (threading test)**

**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ü–µ–ø–æ—á–µ–∫ –æ—Ç–≤–µ—Ç–æ–≤ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏.

**–°–æ–æ–±—â–µ–Ω–∏–µ (–æ—Ç–≤–µ—Ç –Ω–∞ INT-001):**
```
‚úÖ 1 —Ç–µ–π–∫ –≤–∑—è—Ç, —Å—Ç–æ–ø –≤ –±/—É üî•

–ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –¥–µ—Ä–∂–∞—Ç—å –ø–æ–∑–∏—Ü–∏—é –¥–æ 2–≥–æ —Ç–µ–π–∫–∞

üí™ –û—Ç–ª–∏—á–Ω–∞—è —Å–¥–µ–ª–∫–∞ –ø–æ–ª—É—á–∞–µ—Ç—Å—è, +2.4% —É–∂–µ –≤ –∫–∞—Ä–º–∞–Ω–µ
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –∫–∞–∫ **–æ—Ç–≤–µ—Ç** –Ω–∞ INT-001
- –í TARGET_GROUP —Ç–∞–∫–∂–µ —è–≤–ª—è–µ—Ç—Å—è **–æ—Ç–≤–µ—Ç–æ–º** –Ω–∞ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω—ã–π INT-001
- –ü–µ—Ä–µ–≤–æ–¥ —Å–æ–¥–µ—Ä–∂–∏—Ç: "Take profit 1 hit", "stop loss", "breakeven", "holding position"
- Message mapping —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

---

#### **INT-005: Minimal signal (only pair and direction)**

**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≥–∏–±–∫–æ—Å—Ç—å –ø–∞—Ä—Å–µ—Ä–∞ –ø—Ä–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

**–°–æ–æ–±—â–µ–Ω–∏–µ:**
```
#–∏–¥–µ—è DOGE/USDT 5M

üêï –®–û–†–¢ –ø–æ –¥–æ–≥—É

–†–∞–∑–≤–æ—Ä–æ—Ç–Ω–∞—è —Å–≤–µ—á–∞ –Ω–∞ 5 –º–∏–Ω—É—Ç–∫–µ, –∂–¥—É —Å–Ω–∏–∂–µ–Ω–∏—è

‚ö†Ô∏è –ë—É–¥—å—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã, –≤—ã—Å–æ–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å!

–£—Ä–æ–≤–Ω–∏ —Å–∞–º–∏ –æ–ø—Ä–µ–¥–µ–ª—è–π—Ç–µ –ø–æ —Å–∏—Ç—É–∞—Ü–∏–∏ üìä
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ü–∞—Ä—Å–∏–Ω–≥: `DOGE/USDT`, `SHORT`, `5M`
- –ü–∞—Ä—Å–µ—Ä –Ω–µ –ø–∞–¥–∞–µ—Ç –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ entry/SL/TP
- –ü–µ—Ä–µ–≤–æ–¥ —Å–æ–¥–µ—Ä–∂–∏—Ç: "Trading idea", "DOGE/USDT", "SHORT", "high volatility"

---

## –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Å–∫—Ä–∏–ø—Ç–æ–≤

### 1. `generate_mock_images.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–∫–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ç–æ—Ä–≥–æ–≤—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤ –¥–ª—è OCR —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `scripts/generate_mock_images.py`

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```bash
python scripts/generate_mock_images.py
```

**–í—ã–≤–æ–¥:**

–°–æ–∑–¥–∞–µ—Ç 3 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ `tests/data/mock_images/`:
- `signal_ocr_1.png` - SOL/USDT Long 20x (–ø–æ–∑–∏—Ü–∏—è –∞–∫—Ç–∏–≤–Ω–∞)
- `signal_ocr_2.png` - BTC/USDT Short 10x (–ø—Ä–∏–±—ã–ª—å –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞)
- `signal_ocr_3.png` - ETH/USDT Long 15x (—Å–∏–≥–Ω–∞–ª –æ—Ç–∫—Ä—ã—Ç)

**–§–æ—Ä–º–∞—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:**
- –†–∞–∑–º–µ—Ä: 800x600 –ø–∏–∫—Å–µ–ª–µ–π
- –§–æ–Ω: –¢–µ–º–Ω—ã–π (–∏–º–∏—Ç–∞—Ü–∏—è —Ç–æ—Ä–≥–æ–≤–æ–≥–æ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞)
- –¢–µ–∫—Å—Ç: –°–≤–µ—Ç–ª—ã–π, –∫—Ä—É–ø–Ω—ã–π —à—Ä–∏—Ñ—Ç (TrueType)
- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ: Exchange, Pair, Direction, Leverage, Entry, TP, SL, ROI, Status (RU+EN)

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- Python 3.11+
- `Pillow` (—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ requirements.txt)
- TrueType —à—Ä–∏—Ñ—Ç—ã (DejaVu –∏–ª–∏ Liberation) - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ —à—Ä–∏—Ñ—Ç—ã –∏–ª–∏ fallback –Ω–∞ default font.

---

### 2. `run_integration_tests.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Å–Ω–æ–≤–Ω–æ–π —Ä–∞–Ω–Ω–µ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã –≤ SOURCE_GROUP.

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `scripts/run_integration_tests.py`

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã
python scripts/run_integration_tests.py --all

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–µ—Å—Ç—ã
python scripts/run_integration_tests.py --test INT-001 INT-002 INT-003

# Dry-run (–ø–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ, –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏)
python scripts/run_integration_tests.py --all --dry-run

# –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
python scripts/run_integration_tests.py --list

# –ò–∑–º–µ–Ω–∏—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É –º–µ–∂–¥—É —Ç–µ—Å—Ç–∞–º–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 30 —Å–µ–∫)
python scripts/run_integration_tests.py --all --delay 45
```

**–û–ø—Ü–∏–∏:**

| –§–ª–∞–≥       | –û–ø–∏—Å–∞–Ω–∏–µ                                                         | –ü—Ä–∏–º–µ—Ä                     |
|------------|------------------------------------------------------------------|----------------------------|
| `--all`    | –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã –∏–∑ integration_test_signals.json             | `--all`                    |
| `--test`   | –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø–æ ID (—á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª)                  | `--test INT-001 INT-003`   |
| `--dry-run`| –†–µ–∂–∏–º –∏–º–∏—Ç–∞—Ü–∏–∏ (–Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è, —Ç–æ–ª—å–∫–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–ª–∞–Ω) | `--dry-run`                |
| `--list`   | –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ –∏ –≤—ã–π—Ç–∏                    | `--list`                   |
| `--delay N`| –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É —Ç–µ—Å—Ç–∞–º–∏ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 30)              | `--delay 45`               |

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç:**

1. –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ç–µ—Å—Ç—ã –∏–∑ `tests/data/integration_test_signals.json`
2. –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ Telegram —á–µ—Ä–µ–∑ **Reader –∞–∫–∫–∞—É–Ω—Ç** (READER_SESSION_STRING)
3. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø –∫ SOURCE_GROUP
4. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞:
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ SOURCE_GROUP
   - –ü—Ä–∏–∫—Ä–µ–ø–ª—è–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω–æ –≤ —Ç–µ—Å—Ç–µ)
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–∞–∫ –æ—Ç–≤–µ—Ç (–µ—Å–ª–∏ —ç—Ç–æ reply-—Ç–µ—Å—Ç)
   - –ñ–¥–µ—Ç `wait_seconds` + `delay` —Å–µ–∫—É–Ω–¥ –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º —Ç–µ—Å—Ç–æ–º
5. –í—ã–≤–æ–¥–∏—Ç –∏—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç (passed/failed/skipped)

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**

- `READER_API_ID`, `READER_API_HASH`, `READER_PHONE` –≤ `.env`
- `READER_SESSION_STRING` (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) –∏–ª–∏ `READER_SESSION_FILE`
- `SOURCE_GROUP_ID` –≤ `.env`
- Reader –∞–∫–∫–∞—É–Ω—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–ª–µ–Ω–æ–º SOURCE_GROUP —Å **–ø—Ä–∞–≤–∞–º–∏ –Ω–∞ –∑–∞–ø–∏—Å—å**
- `tests/data/integration_test_signals.json` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- –ú–æ–∫–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ–∑–¥–∞–Ω—ã (–¥–ª—è INT-003)

**–í—ã–≤–æ–¥:**

```
==================================================================
Starting Integration Tests
Tests to run: 5
Delay between tests: 30s

[1/5]
============================================================
Running: INT-001 - Basic LONG signal with 2 TPs
  Message: #–∏–¥–µ—è BTC/USDT 4H üìà –¢–æ—Ä–≥–æ–≤–∞—è –∏–¥–µ—è –Ω–∞ –õ–û–ù–ì –ø–æ ...
  Sent message ID: 12345
  Waiting 15s for bot to process...
  Waiting 30s before next test...

[2/5]
============================================================
Running: INT-002 - SHORT signal with 3 TPs
...

============================================================
SUMMARY

Passed: 5/5
  - INT-001 (message ID: 12345)
  - INT-002 (message ID: 12346)
  - INT-003 (message ID: 12347)
  - INT-004 (message ID: 12348)
  - INT-005 (message ID: 12349)

============================================================
```

---

### 3. `verify_target_group.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ TARGET_GROUP –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤.

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `scripts/verify_target_group.py`

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```bash
# –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ä–µ–∂–∏–º: –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 —Å–æ–æ–±—â–µ–Ω–∏–π –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 60 –º–∏–Ω—É—Ç
python scripts/verify_target_group.py

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Å–æ–æ–±—â–µ–Ω–∏–π –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –º–∏–Ω—É—Ç
python scripts/verify_target_group.py --limit 20 --since 30

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å–æ–æ–±—â–µ–Ω–∏–π –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 2 —á–∞—Å–∞
python scripts/verify_target_group.py --limit 50 --since 120
```

**–û–ø—Ü–∏–∏:**

| –§–ª–∞–≥         | –û–ø–∏—Å–∞–Ω–∏–µ                                             | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|--------------|------------------------------------------------------|--------------|
| `--limit N`  | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –≤—ã–±–æ—Ä–∫–∏                     | 10           |
| `--since N`  | –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ N –º–∏–Ω—É—Ç     | 60           |

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç:**

1. –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ Telegram —á–µ—Ä–µ–∑ **Publisher –∞–∫–∫–∞—É–Ω—Ç** (PUBLISHER_SESSION_STRING)
2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø –∫ TARGET_GROUP
3. –ü–æ–ª—É—á–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ `N` —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ TARGET_GROUP
4. –§–∏–ª—å—Ç—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ `--since` –º–∏–Ω—É—Ç)
5. –í—ã–≤–æ–¥–∏—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞–∂–¥–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏:
   - Message ID
   - –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è (UTC)
   - –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è (–æ–±—Ä–µ–∑–∞–µ—Ç—Å—è –¥–æ 200 —Å–∏–º–≤–æ–ª–æ–≤)
   - –ù–∞–ª–∏—á–∏–µ –º–µ–¥–∏–∞ (—Ç–∏–ø)
   - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—Ç–≤–µ—Ç–∞—Ö (reply to message ID)

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**

- `PUBLISHER_API_ID`, `PUBLISHER_API_HASH`, `PUBLISHER_PHONE` –≤ `.env`
- `PUBLISHER_SESSION_STRING` (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) –∏–ª–∏ `PUBLISHER_SESSION_FILE`
- `TARGET_GROUP_ID` –≤ `.env`
- Publisher –∞–∫–∫–∞—É–Ω—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–ª–µ–Ω–æ–º TARGET_GROUP

**–í—ã–≤–æ–¥:**

```
Using StringSession for authentication...
Connected as: Publisher Bot (ID: 987654321, @publisher_account)
Target group: Test Signals EN (ID: -100987654321)

Fetching up to 10 messages from last 60 minutes...
============================================================

Recent messages in TARGET_GROUP (last 60 min):
============================================================

[54321] 2025-12-03 14:32:15 UTC
Text: #idea BTC/USDT 4H üìà Trading idea for LONG on Bitcoin Entry: 62500 - 63000 Stop: 61500 Take 1: 64500 Take 2: 66000 Risk: 2% ‚ö†Ô∏è Enter only upon volume confirmation
Media: No
Reply to: None

------------------------------------------------------------

[54322] 2025-12-03 14:32:45 UTC
Text: #IDEA ETH/USDT 1H üìâ üî¥ SHORT on Ethereum Entry zone: 2480 - 2520 üí∞ Stop loss: 2570 Targets: Take 1: 2400 üéØ Take 2: 2350 üéØ Take 3: 2280 üéØ Risk 1.5% of deposit...
Media: No
Reply to: None

------------------------------------------------------------

[54323] 2025-12-03 14:33:20 UTC
Text: #idea SOL/USDT 15M üöÄ Looking at LONG on Solana Details in the screenshot üëá ‚ö°Ô∏è Quick trade, watch the volumes!
Media: Yes (MessageMediaPhoto)
Reply to: None

------------------------------------------------------------

[54324] 2025-12-03 14:34:05 UTC
Text: ‚úÖ Take profit 1 hit, stop loss at breakeven üî• Continuing to hold position until 2nd take profit üí™ Excellent trade shaping up, +2.4% already in the pocket
Media: No
Reply to: 54321

------------------------------------------------------------

============================================================
Found 4 message(s) in the last 60 minutes.

Disconnected.
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏:**

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ `run_integration_tests.py` –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
- –í—Å–µ –ª–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –∏ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω—ã
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–≤–æ–¥–æ–≤ (–≤–∏–∑—É–∞–ª—å–Ω—ã–π –æ—Å–º–æ—Ç—Ä)
- –°–æ—Ö—Ä–∞–Ω–µ–Ω—ã –ª–∏ —Ü–µ–ø–æ—á–∫–∏ –æ—Ç–≤–µ—Ç–æ–≤ (INT-004 –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å reply –∫ INT-001)
- –ü—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω—ã –ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (INT-003)

---

## –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É —Ç–µ—Å—Ç–æ–≤

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

#### 1.1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–∞ `.env`

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ .env
ls -la .env

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
grep -E "^(READER_|PUBLISHER_|SOURCE_|TARGET_|GEMINI_|POSTGRES_)" .env
```

–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
- `READER_API_ID`, `READER_API_HASH`, `READER_PHONE`, `READER_SESSION_STRING`
- `PUBLISHER_API_ID`, `PUBLISHER_API_HASH`, `PUBLISHER_PHONE`, `PUBLISHER_SESSION_STRING`
- `SOURCE_GROUP_ID`, `TARGET_GROUP_ID`
- `GEMINI_API_KEY`
- `POSTGRES_PASSWORD`

#### 1.2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –≥—Ä—É–ø–ø–∞–º

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø Reader –∫ SOURCE_GROUP
python scripts/get_group_id.py reader

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø Publisher –∫ TARGET_GROUP
python scripts/get_group_id.py publisher
```

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:
- Reader –≤–∏–¥–∏—Ç SOURCE_GROUP –∏ –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å
- Publisher –≤–∏–¥–∏—Ç TARGET_GROUP –∏ –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å

#### 1.3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–≤–æ—Ç Gemini API

–í–æ–π–¥–∏—Ç–µ –≤ [Google AI Studio](https://aistudio.google.com/) –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
- –ö–≤–æ—Ç–∞ API: ‚â•100 –∑–∞–ø—Ä–æ—Å–æ–≤/–¥–µ–Ω—å
- –õ–∏–º–∏—Ç —Ç–æ–∫–µ–Ω–æ–≤: –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è 5 —Ç–µ—Å—Ç–æ–≤ √ó 2 –∑–∞–ø—Ä–æ—Å–∞ (–ø–µ—Ä–µ–≤–æ–¥ + OCR)

---

### 2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–æ–∫–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

```bash
# –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
source .venv/bin/activate

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä
python scripts/generate_mock_images.py
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**

```
================================================================================
Generating Mock Trading Chart Images for OCR Testing
================================================================================

Output directory: /home/user/telegram-signals-parisng/tests/data/mock_images

Generating 3 images...

‚úì Generated: /home/user/telegram-signals-parisng/tests/data/mock_images/signal_ocr_1.png
‚úì Generated: /home/user/telegram-signals-parisng/tests/data/mock_images/signal_ocr_2.png
‚úì Generated: /home/user/telegram-signals-parisng/tests/data/mock_images/signal_ocr_3.png

================================================================================
‚úì All images generated successfully!
================================================================================

Images saved to: /home/user/telegram-signals-parisng/tests/data/mock_images

Generated files:
  - signal_ocr_1.png (23.4 KB)
  - signal_ocr_2.png (22.8 KB)
  - signal_ocr_3.png (23.1 KB)

You can now use these images for OCR testing.
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**

```bash
ls -lh tests/data/mock_images/
```

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å 3 PNG —Ñ–∞–π–ª–∞ —Ä–∞–∑–º–µ—Ä–æ–º ~20-25 KB.

---

### 3. –ó–∞–ø—É—Å–∫ Docker-—Å–µ—Ä–≤–∏—Å–æ–≤

#### 3.1. –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (–µ—Å–ª–∏ –µ—Å—Ç—å)
docker-compose down

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑—ã (–µ—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª—Å—è –∫–æ–¥)
docker-compose build --no-cache

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose up -d
```

#### 3.2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä–≤–∏—Å–æ–≤

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker-compose ps
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**

```
NAME                COMMAND                  SERVICE   STATUS    PORTS
signal_bot_app      "python -m src.main"     app       running   0.0.0.0:8000->8000/tcp
signal_bot_db       "docker-entrypoint.s‚Ä¶"   db        running   0.0.0.0:5432->5432/tcp
signal_bot_redis    "docker-entrypoint.s‚Ä¶"   redis     running   0.0.0.0:6379->6379/tcp
```

–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ —Å—Ç–∞—Ç—É—Å–µ **running**.

#### 3.3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
# –°–ª–µ–¥–∏—Ç—å –∑–∞ –ª–æ–≥–∞–º–∏ –±–æ—Ç–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
docker-compose logs -f app
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**

```
signal_bot_app | 2025-12-03 14:15:30 INFO     Starting Telegram Signal Translator Bot
signal_bot_app | 2025-12-03 14:15:31 INFO     Initializing Reader client...
signal_bot_app | 2025-12-03 14:15:32 INFO     Reader connected: User(id=123456789, username=reader_account)
signal_bot_app | 2025-12-03 14:15:33 INFO     Initializing Publisher client...
signal_bot_app | 2025-12-03 14:15:34 INFO     Publisher connected: User(id=987654321, username=publisher_account)
signal_bot_app | 2025-12-03 14:15:35 INFO     Database connection pool initialized
signal_bot_app | 2025-12-03 14:15:36 INFO     Listening for signals in SOURCE_GROUP: -100123456789
signal_bot_app | 2025-12-03 14:15:36 INFO     Bot is ready. Waiting for signals...
```

–ï—Å–ª–∏ –±–æ—Ç —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è –∫ –æ–±–æ–∏–º –∞–∫–∫–∞—É–Ω—Ç–∞–º –∏ —Å–ª—É—à–∞–µ—Ç SOURCE_GROUP - –º–æ–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å.

#### 3.4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ PostgreSQL
docker-compose exec db psql -U postgres signal_bot

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ —Ç–∞–±–ª–∏—Ü
\dt

# –í—ã—Ö–æ–¥ –∏–∑ psql
\q
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**

```
              List of relations
 Schema |         Name          | Type  |  Owner
--------+-----------------------+-------+----------
 public | signals               | table | postgres
 public | signal_updates        | table | postgres
 public | translation_cache     | table | postgres
```

---

### 4. –ó–∞–ø—É—Å–∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤

#### 4.1. –°—É—Ö–æ–π –ø—Ä–æ–≥–æ–Ω (dry-run)

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Ç–µ—Å—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω—ã:

```bash
# –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Ç–µ—Å—Ç–æ–≤
python scripts/run_integration_tests.py --list
```

**–í—ã–≤–æ–¥:**

```
Available Integration Tests:

INT-001: Basic LONG signal with 2 TPs
  Standard trading signal with complete fields including entry range, stop loss, and two take profit levels

INT-002: SHORT signal with 3 TPs
  Comprehensive SHORT signal with three take profit levels and tight entry range

INT-003: Signal WITH IMAGE (OCR test)
  Minimal text signal with chart image requiring OCR to extract trading parameters
  [image, wait 20s]

INT-004: REPLY to INT-001 (threading test)
  Update message replying to original signal, indicating first take profit hit and stop loss moved to breakeven
  [reply to INT-001]

INT-005: Minimal signal (only pair and direction)
  Bare minimum signal with just pair, direction, and timeframe - testing parser flexibility
```

**Dry-run mode:**

```bash
python scripts/run_integration_tests.py --all --dry-run
```

–≠—Ç–æ –ø–æ–∫–∞–∂–µ—Ç –ø–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è **–±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏** —Å–æ–æ–±—â–µ–Ω–∏–π.

#### 4.2. –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤

```bash
python scripts/run_integration_tests.py --all
```

**–ü—Ä–æ—Ü–µ—Å—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**

```
Using StringSession for authentication
Connected as: Reader Account (@reader_account)
User ID: 123456789

Access verified to SOURCE_GROUP:
  Group ID: -100123456789
  Group Title: Test Signals RU

============================================================
Starting Integration Tests
Tests to run: 5
Delay between tests: 30s

[1/5]
============================================================
Running: INT-001 - Basic LONG signal with 2 TPs
  Message: #–∏–¥–µ—è BTC/USDT 4H üìà –¢–æ—Ä–≥–æ–≤–∞—è –∏–¥–µ—è –Ω–∞ –õ–û–ù...
  Sent message ID: 54001
  Waiting 15s for bot to process...
  Waiting 30s before next test...

[2/5]
============================================================
Running: INT-002 - SHORT signal with 3 TPs
  Message: #–ò–î–ï–Ø ETH/USDT 1H üìâ üî¥ –®–û–†–¢ –ø–æ —ç—Ñ–∏—Ä–∏—É–º—É...
  Sent message ID: 54002
  Waiting 15s for bot to process...
  Waiting 30s before next test...

[3/5]
============================================================
Running: INT-003 - Signal WITH IMAGE (OCR test)
  Image: mock_images/signal_ocr_1.png
  Message: #–∏–¥–µ—è SOL/USDT 15M üöÄ –°–º–æ—Ç—Ä–∏–º –õ–û–ù–ì –ø–æ –°–æ...
  Sent message ID: 54003
  Waiting 20s for bot to process...
  Waiting 30s before next test...

[4/5]
============================================================
Running: INT-004 - REPLY to INT-001 (threading test)
  Replying to message ID: 54001
  Message: ‚úÖ 1 —Ç–µ–π–∫ –≤–∑—è—Ç, —Å—Ç–æ–ø –≤ –±/—É üî• –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º...
  Sent message ID: 54004
  Waiting 15s for bot to process...
  Waiting 30s before next test...

[5/5]
============================================================
Running: INT-005 - Minimal signal (only pair and direction)
  Message: #–∏–¥–µ—è DOGE/USDT 5M üêï –®–û–†–¢ –ø–æ –¥–æ–≥—É –†–∞–∑–≤–æ...
  Sent message ID: 54005
  Waiting 15s for bot to process...
  Waiting 30s before next test...

============================================================
SUMMARY

Passed: 5/5
  - INT-001 (message ID: 54001)
  - INT-002 (message ID: 54002)
  - INT-003 (message ID: 54003)
  - INT-004 (message ID: 54004)
  - INT-005 (message ID: 54005)

============================================================

Disconnected from Telegram
```

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~3-4 –º–∏–Ω—É—Ç—ã (5 —Ç–µ—Å—Ç–æ–≤ √ó ~15-20 —Å–µ–∫ wait_seconds + 30 —Å–µ–∫ delay –º–µ–∂–¥—É —Ç–µ—Å—Ç–∞–º–∏)

#### 4.3. –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤

–î–ª—è –æ—Ç–ª–∞–¥–∫–∏ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã:

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ INT-001
python scripts/run_integration_tests.py --test INT-001

# –ó–∞–ø—É—Å—Ç–∏—Ç—å INT-001 –∏ INT-003 (—Ç–µ–∫—Å—Ç + OCR)
python scripts/run_integration_tests.py --test INT-001 INT-003

# –ó–∞–ø—É—Å—Ç–∏—Ç—å threading —Ç–µ—Å—Ç—ã (INT-001 –∏ INT-004)
python scripts/run_integration_tests.py --test INT-001 INT-004
```

**–í–ê–ñ–ù–û:** –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ INT-004 (reply test) **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** —Å–Ω–∞—á–∞–ª–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—å INT-001, –∏–Ω–∞—á–µ INT-004 –±—É–¥–µ—Ç –ø—Ä–æ–ø—É—â–µ–Ω (skipped).

#### 4.4. –£–º–µ–Ω—å—à–µ–Ω–∏–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```bash
# –£–º–µ–Ω—å—à–∏—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É –º–µ–∂–¥—É —Ç–µ—Å—Ç–∞–º–∏ –¥–æ 10 —Å–µ–∫—É–Ω–¥
python scripts/run_integration_tests.py --all --delay 10
```

**–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ:** –°–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø—Ä–æ–ø—É—Å–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π, –µ—Å–ª–∏ –±–æ—Ç –Ω–µ —É—Å–ø–µ–≤–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Å–∏–≥–Ω–∞–ª.

---

### 5. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ –±–æ—Ç–∞

–í–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤ –æ—Ç–∫—Ä–æ–π—Ç–µ –≤—Ç–æ—Ä–æ–π —Ç–µ—Ä–º–∏–Ω–∞–ª –∏ —Å–ª–µ–¥–∏—Ç–µ –∑–∞ –ª–æ–≥–∞–º–∏:

```bash
# –¢–µ—Ä–º–∏–Ω–∞–ª 2: –õ–æ–≥–∏ –±–æ—Ç–∞
docker-compose logs -f app
```

**–ß—Ç–æ —Å–º–æ—Ç—Ä–µ—Ç—å:**

‚úÖ **–£—Å–ø–µ—à–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞:**

```
signal_bot_app | 2025-12-03 14:30:15 INFO     New message detected: ID=54001, from_user=123456789
signal_bot_app | 2025-12-03 14:30:15 INFO     Signal detected: #–∏–¥–µ—è
signal_bot_app | 2025-12-03 14:30:15 INFO     Parsing signal...
signal_bot_app | 2025-12-03 14:30:16 INFO     Parsed: pair=BTC/USDT, direction=LONG, entry=62500-63000
signal_bot_app | 2025-12-03 14:30:16 INFO     Translating text via Gemini API...
signal_bot_app | 2025-12-03 14:30:18 INFO     Translation successful (latency: 1.84s)
signal_bot_app | 2025-12-03 14:30:18 INFO     Publishing to TARGET_GROUP...
signal_bot_app | 2025-12-03 14:30:19 INFO     Published: message_id=67001
signal_bot_app | 2025-12-03 14:30:19 INFO     Mapping saved: source=54001 -> target=67001
```

‚ùå **–û—à–∏–±–∫–∏, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ:**

```
signal_bot_app | ERROR    Gemini API error: quota exceeded
signal_bot_app | ERROR    Translation fallback: using Google Translate
signal_bot_app | ERROR    OCR failed for image: unsupported format
signal_bot_app | ERROR    Publisher client not connected
```

---

### 6. –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

#### 6.1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç

```bash
# –¢–µ—Ä–º–∏–Ω–∞–ª 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ TARGET_GROUP
python scripts/verify_target_group.py --limit 10 --since 30
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:** 5 –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (INT-001 to INT-005) —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –ø–µ—Ä–µ–≤–æ–¥–∞–º–∏.

#### 6.2. –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ Telegram

–û—Ç–∫—Ä–æ–π—Ç–µ Telegram —á–µ—Ä–µ–∑ Publisher –∞–∫–∫–∞—É–Ω—Ç:

1. –û—Ç–∫—Ä–æ–π—Ç–µ TARGET_GROUP
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 —Å–æ–æ–±—â–µ–Ω–∏–π
3. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–≤–æ–¥–æ–≤:
   - ‚úÖ –†—É—Å—Å–∫–∏–π —Ç–µ–∫—Å—Ç –ø–µ—Ä–µ–≤–µ–¥–µ–Ω –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π
   - ‚úÖ –¢–æ—Ä–≥–æ–≤—ã–µ —Ç–µ—Ä–º–∏–Ω—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã (LONG, SHORT, TP1, SL, BTC/USDT)
   - ‚úÖ –≠–º–æ–¥–∑–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã
   - ‚úÖ INT-003 —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
   - ‚úÖ INT-004 —è–≤–ª—è–µ—Ç—Å—è **–æ—Ç–≤–µ—Ç–æ–º** (reply) –Ω–∞ INT-001

#### 6.3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–∞–ø–ø–∏–Ω–≥ —Å–æ–æ–±—â–µ–Ω–∏–π
docker-compose exec db psql -U postgres signal_bot -c "
SELECT
  source_message_id,
  target_message_id,
  pair,
  direction,
  created_at
FROM signals
ORDER BY created_at DESC
LIMIT 5;
"
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**

```
 source_message_id | target_message_id |   pair    | direction |         created_at
-------------------+-------------------+-----------+-----------+----------------------------
             54005 |             67005 | DOGE/USDT | SHORT     | 2025-12-03 14:34:30.123456
             54004 |             67004 | NULL      | NULL      | 2025-12-03 14:33:45.123456
             54003 |             67003 | SOL/USDT  | LONG      | 2025-12-03 14:33:00.123456
             54002 |             67002 | ETH/USDT  | SHORT     | 2025-12-03 14:32:15.123456
             54001 |             67001 | BTC/USDT  | LONG      | 2025-12-03 14:31:30.123456
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ reply –º–∞–ø–ø–∏–Ω–≥–∞:**

```bash
docker-compose exec db psql -U postgres signal_bot -c "
SELECT
  source_update_id,
  target_update_id,
  parent_signal_id,
  created_at
FROM signal_updates
ORDER BY created_at DESC
LIMIT 5;
"
```

INT-004 –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø–∏—Å–∞–Ω –∫–∞–∫ update —Å `parent_signal_id` —Å—Å—ã–ª–∞—é—â–∏–º—Å—è –Ω–∞ INT-001.

---

## –ü–æ–∏—Å–∫ –∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ë–æ—Ç –Ω–µ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è

**–°–∏–º–ø—Ç–æ–º—ã:**
- –°–æ–æ–±—â–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ SOURCE_GROUP
- –í –ª–æ–≥–∞—Ö –±–æ—Ç–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π –æ –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –∏ —Ä–µ—à–µ–Ω–∏—è:**

1. **Reader –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ SOURCE_GROUP**
   ```bash
   # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≥—Ä—É–ø–ø—ã Reader –∞–∫–∫–∞—É–Ω—Ç–∞
   python scripts/get_group_id.py reader
   ```
   –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ SOURCE_GROUP_ID –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ —Å–ø–∏—Å–∫–µ.

2. **–ù–µ–≤–µ—Ä–Ω—ã–π SOURCE_GROUP_ID**
   ```bash
   # –í .env –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç (–¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å -100)
   grep SOURCE_GROUP_ID .env
   ```
   –§–æ—Ä–º–∞—Ç: `-100123456789` (–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –¥–ª—è supergroups)

3. **Reader client –Ω–µ –∑–∞–ø—É—â–µ–Ω**
   ```bash
   # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
   docker-compose logs app | grep "Reader connected"
   ```
   –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∑–∞–ø–∏—Å—å –æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ Reader –∞–∫–∫–∞—É–Ω—Ç–∞.

4. **–ù–µ–≤–µ—Ä–Ω—ã–π session string**
   ```bash
   # –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å session string
   python scripts/auth_local.py
   # –û–±–Ω–æ–≤–∏—Ç—å READER_SESSION_STRING –≤ .env
   # –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
   docker-compose restart app
   ```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ü–µ—Ä–µ–≤–æ–¥ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–°–∏–º–ø—Ç–æ–º—ã:**
- –°–∏–≥–Ω–∞–ª—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã (–µ—Å—Ç—å –≤ –ª–æ–≥–∞—Ö)
- –ü–µ—Ä–µ–≤–æ–¥–∞ –≤ TARGET_GROUP –Ω–µ—Ç –∏–ª–∏ —Ç–µ–∫—Å—Ç –Ω–∞ —Ä—É—Å—Å–∫–æ–º

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –∏ —Ä–µ—à–µ–Ω–∏—è:**

1. **Gemini API quota exceeded**
   ```bash
   # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏ API
   docker-compose logs app | grep -i "gemini\|quota\|error"
   ```
   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–≤–æ—Ç—É –Ω–∞ [Google AI Studio](https://aistudio.google.com/).

2. **–ù–µ–≤–µ—Ä–Ω—ã–π Gemini API Key**
   ```bash
   # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–ª—é—á
   grep GEMINI_API_KEY .env

   # –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –∫ API (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ curl –∏–ª–∏ —Å–∫—Ä–∏–ø—Ç)
   curl -X POST "https://generativelanguage.googleapis.com/v1/models/gemini-2.0-flash:generateContent?key=YOUR_KEY" \
     -H 'Content-Type: application/json' \
     -d '{"contents":[{"parts":[{"text":"Hello"}]}]}'
   ```

3. **Fallback –Ω–∞ Google Translate –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω**

   –ï—Å–ª–∏ Gemini –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω, –±–æ—Ç –¥–æ–ª–∂–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ Google Translate. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
   ```bash
   docker-compose logs app | grep "fallback\|Google Translate"
   ```

4. **Timeout —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π**

   –í `.env` —É–≤–µ–ª–∏—á—å—Ç–µ timeout:
   ```ini
   TIMEOUT_GEMINI_SEC=60  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 30
   ```

   –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ:
   ```bash
   docker-compose restart app
   ```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 3: OCR –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç —Ç–µ–∫—Å—Ç –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ (INT-003)
- –¢–µ–∫—Å—Ç –ø–µ—Ä–µ–≤–µ–¥–µ–Ω, –Ω–æ –Ω–µ—Ç OCR –¥–∞–Ω–Ω—ã—Ö –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –∏ —Ä–µ—à–µ–Ω–∏—è:**

1. **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ —Å–æ–∑–¥–∞–Ω—ã**
   ```bash
   ls -la tests/data/mock_images/
   ```
   –î–æ–ª–∂–Ω—ã –±—ã—Ç—å 3 PNG —Ñ–∞–π–ª–∞. –ï—Å–ª–∏ –Ω–µ—Ç:
   ```bash
   python scripts/generate_mock_images.py
   ```

2. **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–µ**

   –í `.env` –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–∏–º–∏—Ç:
   ```ini
   MAX_IMAGE_SIZE_MB=50  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 50 MB
   ```

3. **Gemini Vision API –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω**

   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
   ```bash
   docker-compose logs app | grep -i "ocr\|vision\|image"
   ```

   –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–æ–¥–µ–ª—å —Å Vision –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π:
   ```ini
   GEMINI_MODEL=gemini-2.0-flash  # –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Vision
   ```

4. **–§–æ—Ä–º–∞—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è**

   Gemini Vision –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç: JPEG, PNG, WEBP, GIF.
   –ú–æ–∫–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –≤ PNG (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è).

---

### –ü—Ä–æ–±–ª–µ–º–∞ 4: –°–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –ø—É–±–ª–∏–∫—É—é—Ç—Å—è –≤ TARGET_GROUP

**–°–∏–º–ø—Ç–æ–º—ã:**
- –°–∏–≥–Ω–∞–ª—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∏ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã
- –í TARGET_GROUP –Ω–µ—Ç –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –∏ —Ä–µ—à–µ–Ω–∏—è:**

1. **Publisher –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ TARGET_GROUP**
   ```bash
   python scripts/get_group_id.py publisher
   ```
   –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ TARGET_GROUP_ID –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ —Å–ø–∏—Å–∫–µ.

2. **Publisher –Ω–µ –∏–º–µ–µ—Ç –ø—Ä–∞–≤ –Ω–∞ –∑–∞–ø–∏—Å—å**

   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ Publisher –∞–∫–∫–∞—É–Ω—Ç–∞ –≤ TARGET_GROUP:
   - –û—Ç–∫—Ä–æ–π—Ç–µ –≥—Ä—É–ø–ø—É —á–µ—Ä–µ–∑ Publisher –∞–∫–∫–∞—É–Ω—Ç
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –º–æ–∂–µ—Ç–µ –ª–∏ –≤—ã –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤—Ä—É—á–Ω—É—é
   - –ï—Å–ª–∏ –≥—Ä—É–ø–ø–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è (Read-Only), –∏–∑–º–µ–Ω–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

3. **Publisher client –Ω–µ –∑–∞–ø—É—â–µ–Ω**
   ```bash
   docker-compose logs app | grep "Publisher connected"
   ```

4. **–ù–µ–≤–µ—Ä–Ω—ã–π TARGET_GROUP_ID**
   ```bash
   grep TARGET_GROUP_ID .env
   ```
   –§–æ—Ä–º–∞—Ç: `-100987654321`

---

### –ü—Ä–æ–±–ª–µ–º–∞ 5: –¢—Ä–µ–¥–∏–Ω–≥ —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (INT-004)

**–°–∏–º–ø—Ç–æ–º—ã:**
- INT-004 –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –∫–∞–∫ –æ—Ç–≤–µ—Ç –Ω–∞ INT-001 –≤ SOURCE_GROUP
- –í TARGET_GROUP INT-004 **–Ω–µ —è–≤–ª—è–µ—Ç—Å—è –æ—Ç–≤–µ—Ç–æ–º** –Ω–∞ INT-001

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –∏ —Ä–µ—à–µ–Ω–∏—è:**

1. **–ú–∞–ø–ø–∏–Ω–≥ –Ω–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ –ë–î**

   –ü—Ä–æ–≤–µ—Ä–∏—Ç—å:
   ```bash
   docker-compose exec db psql -U postgres signal_bot -c "
   SELECT source_message_id, target_message_id
   FROM signals
   WHERE source_message_id = 54001;
   "
   ```

   –ï—Å–ª–∏ –ø—É—Å—Ç–æ - –º–∞–ø–ø–∏–Ω–≥ –Ω–µ —Å–æ—Ö—Ä–∞–Ω–∏–ª—Å—è. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏ –ë–î:
   ```bash
   docker-compose logs app | grep -i "database\|postgres\|error"
   ```

2. **Reply ID –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω**

   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ INT-004:
   ```bash
   docker-compose logs app | grep -A5 "message.*54004"
   ```

   –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∑–∞–ø–∏—Å—å –æ –ø–æ–∏—Å–∫–µ parent signal.

3. **INT-001 –Ω–µ –±—ã–ª –æ–±—Ä–∞–±–æ—Ç–∞–Ω –ø–µ—Ä–≤—ã–º**

   –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Ç–µ—Å—Ç–æ–≤ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ INT-001 –≤—ã–ø–æ–ª–Ω–µ–Ω **–¥–æ** INT-004:
   ```bash
   python scripts/run_integration_tests.py --test INT-001 INT-004
   ```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 6: –¢–µ—Å—Ç—ã –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è (Skipped)

**–°–∏–º–ø—Ç–æ–º—ã:**
- –í –æ—Ç—á–µ—Ç–µ —Ç–µ—Å—Ç–æ–≤ –µ—Å—Ç—å "Skipped" –∑–∞–ø–∏—Å–∏

**–ü—Ä–∏—á–∏–Ω—ã:**

1. **Parent test –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω (–¥–ª—è reply tests)**

   INT-004 —Ç—Ä–µ–±—É–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è INT-001 —Å–Ω–∞—á–∞–ª–∞.

   **–†–µ—à–µ–Ω–∏–µ:**
   ```bash
   # –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–±–∞ —Ç–µ—Å—Ç–∞ –≤–º–µ—Å—Ç–µ
   python scripts/run_integration_tests.py --test INT-001 INT-004

   # –ò–ª–∏ –≤—Å–µ —Ç–µ—Å—Ç—ã
   python scripts/run_integration_tests.py --all
   ```

2. **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ**

   INT-003 —Ç—Ä–µ–±—É–µ—Ç –Ω–∞–ª–∏—á–∏–µ `tests/data/mock_images/signal_ocr_1.png`.

   **–†–µ—à–µ–Ω–∏–µ:**
   ```bash
   python scripts/generate_mock_images.py
   ```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 7: –°–∫—Ä–∏–ø—Ç verify_target_group.py –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è

**–°–∏–º–ø—Ç–æ–º—ã:**
- –¢–µ—Å—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ
- verify_target_group.py –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –∏ —Ä–µ—à–µ–Ω–∏—è:**

1. **–í—Ä–µ–º—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–æ–µ**

   –£–≤–µ–ª–∏—á—å—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä `--since`:
   ```bash
   python scripts/verify_target_group.py --since 120  # 2 —á–∞—Å–∞
   ```

2. **–õ–∏–º–∏—Ç —Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∏–π**

   –£–≤–µ–ª–∏—á—å—Ç–µ `--limit`:
   ```bash
   python scripts/verify_target_group.py --limit 50
   ```

3. **Publisher –Ω–µ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ TARGET_GROUP**

   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
   ```bash
   python scripts/get_group_id.py publisher
   ```

4. **–°–æ–æ–±—â–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω–æ –Ω–µ –±—ã–ª–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã**

   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±–æ—Ç–∞ –Ω–∞ –æ—à–∏–±–∫–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏:
   ```bash
   docker-compose logs app | grep -i "publish\|target_group\|error"
   ```

---

## –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —É—Å–ª–æ–≤–∏—è:

#### 1. –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã (5/5)

```
SUMMARY

Passed: 5/5
  - INT-001 (message ID: 54001)
  - INT-002 (message ID: 54002)
  - INT-003 (message ID: 54003)
  - INT-004 (message ID: 54004)
  - INT-005 (message ID: 54005)

Failed: 0/5
Skipped: 0/5
```

#### 2. –ü–µ—Ä–µ–≤–æ–¥—ã –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ TARGET_GROUP

–ó–∞–ø—É—Å–∫ `verify_target_group.py` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç **5 –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π**:

- **INT-001:** –ü–µ—Ä–µ–≤–æ–¥ BTC/USDT LONG —Å–∏–≥–Ω–∞–ª–∞
- **INT-002:** –ü–µ—Ä–µ–≤–æ–¥ ETH/USDT SHORT —Å–∏–≥–Ω–∞–ª–∞ —Å 3 —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç–∞–º–∏
- **INT-003:** –ü–µ—Ä–µ–≤–æ–¥ SOL/USDT LONG —Å–∏–≥–Ω–∞–ª–∞ + **–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ**
- **INT-004:** –ü–µ—Ä–µ–≤–æ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–∞–∫ **–æ—Ç–≤–µ—Ç** –Ω–∞ INT-001
- **INT-005:** –ü–µ—Ä–µ–≤–æ–¥ DOGE/USDT SHORT –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞

#### 3. –ö–∞—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ–≤–æ–¥–æ–≤

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- ‚úÖ –†—É—Å—Å–∫–∏–π —Ç–µ–∫—Å—Ç –ø–µ—Ä–µ–≤–µ–¥–µ–Ω –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π
- ‚úÖ –¢–æ—Ä–≥–æ–≤—ã–µ —Ç–µ—Ä–º–∏–Ω—ã **–Ω–µ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã**: LONG, SHORT, TP1, TP2, TP3, SL, BTC/USDT, ETH/USDT
- ‚úÖ –≠–º–æ–¥–∑–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã: üìà, üìâ, üöÄ, üéØ, ‚ö†Ô∏è
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ (–ø–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫, —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
- ‚úÖ –ß–∏—Å–ª–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ –∏–∑–º–µ–Ω–µ–Ω—ã (62500, 2480, 155.00)

**–ü—Ä–∏–º–µ—Ä –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞ (INT-001):**

–ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç:
```
#–∏–¥–µ—è BTC/USDT 4H üìà

–¢–æ—Ä–≥–æ–≤–∞—è –∏–¥–µ—è –Ω–∞ –õ–û–ù–ì –ø–æ –±–∏—Ç–∫–æ–∏–Ω—É

–í—Ö–æ–¥: 62500 - 63000
–°—Ç–æ–ø: 61500
–¢–µ–π–∫ 1: 64500
–¢–µ–π–∫ 2: 66000

–†–∏—Å–∫: 2%

‚ö†Ô∏è –í—Ö–æ–¥–∏–º —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏ –æ–±—ä–µ–º–æ–≤
```

–ü–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç:
```
#idea BTC/USDT 4H üìà

Trading idea for LONG on Bitcoin

Entry: 62500 - 63000
Stop: 61500
Take 1: 64500
Take 2: 66000

Risk: 2%

‚ö†Ô∏è Enter only upon volume confirmation
```

#### 4. OCR –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Ç–µ–∫—Å—Ç (INT-003)

–ü–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ INT-003 –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:

```
#idea SOL/USDT 15M

üöÄ Looking at LONG on Solana

Details in the screenshot üëá

‚ö°Ô∏è Quick trade, watch the volumes!

[–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–æ]

---
OCR Extracted Data:
Exchange: BYBIT
Pair: SOLUSDT
Direction: Long 20x
Entry: 148.50
TP: 155.00
SL: 145.00
ROI: +4.38%
Status: Position Active
```

#### 5. –¢—Ä–µ–¥–∏–Ω–≥ —Ä–∞–±–æ—Ç–∞–µ—Ç (INT-004 ‚Üí INT-001)

–í TARGET_GROUP:

- INT-001 –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω —Å message_id, –Ω–∞–ø—Ä–∏–º–µ—Ä `67001`
- INT-004 –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω —Å message_id, –Ω–∞–ø—Ä–∏–º–µ—Ä `67004`
- INT-004 —è–≤–ª—è–µ—Ç—Å—è **–æ—Ç–≤–µ—Ç–æ–º** (reply) –Ω–∞ `67001`

–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ Telegram:
- –û—Ç–∫—Ä–æ–π—Ç–µ INT-004 –≤ TARGET_GROUP
- –ù–∞–¥ —Å–æ–æ–±—â–µ–Ω–∏–µ–º –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ª–∏–Ω–∏—è/—Å—Å—ã–ª–∫–∞ –Ω–∞ INT-001
- –ö–ª–∏–∫ –Ω–∞ –ª–∏–Ω–∏—é –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –∫ INT-001

#### 6. –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –ë–î

**–¢–∞–±–ª–∏—Ü–∞ `signals`:**

```sql
SELECT source_message_id, target_message_id, pair, direction
FROM signals
ORDER BY created_at DESC
LIMIT 5;
```

| source_message_id | target_message_id | pair      | direction |
|-------------------|-------------------|-----------|-----------|
| 54001             | 67001             | BTC/USDT  | LONG      |
| 54002             | 67002             | ETH/USDT  | SHORT     |
| 54003             | 67003             | SOL/USDT  | LONG      |
| 54005             | 67005             | DOGE/USDT | SHORT     |

**–¢–∞–±–ª–∏—Ü–∞ `signal_updates`:**

```sql
SELECT source_update_id, target_update_id, parent_signal_id
FROM signal_updates
ORDER BY created_at DESC
LIMIT 5;
```

| source_update_id | target_update_id | parent_signal_id |
|------------------|------------------|------------------|
| 54004            | 67004            | 67001            |

`parent_signal_id` –¥–æ–ª–∂–µ–Ω —Å—Å—ã–ª–∞—Ç—å—Å—è –Ω–∞ `target_message_id` –∏–∑ INT-001.

#### 7. –õ–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –Ω–æ—Ä–º—ã

**–¶–µ–ª–µ–≤–∞—è –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å:** <60 —Å–µ–∫—É–Ω–¥ –æ—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–∏–≥–Ω–∞–ª–∞ –¥–æ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –ø–µ—Ä–µ–≤–æ–¥–∞.

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –ª–æ–≥–∞—Ö:
```bash
docker-compose logs app | grep "latency\|processing_time"
```

**–¢–∏–ø–∏—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:**
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞: <100 –º—Å
- –ü–∞—Ä—Å–∏–Ω–≥: <200 –º—Å
- –ü–µ—Ä–µ–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞ (Gemini): 3-8 —Å–µ–∫
- OCR –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: 2-5 —Å–µ–∫
- –ü—É–±–ª–∏–∫–∞—Ü–∏—è: 500 –º—Å - 1 —Å–µ–∫
- **Total:** ~6-15 —Å–µ–∫ ‚úÖ

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–≤–æ–¥–æ–≤

–û—Ç–ø—Ä–∞–≤—å—Ç–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Å–∏–≥–Ω–∞–ª –¥–≤–∞–∂–¥—ã:

```bash
# –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫
python scripts/run_integration_tests.py --test INT-001

# –í—Ç–æ—Ä–æ–π –∑–∞–ø—É—Å–∫ (—á–µ—Ä–µ–∑ 1 –º–∏–Ω—É—Ç—É)
python scripts/run_integration_tests.py --test INT-001
```

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –≤—Ç–æ—Ä–æ–π –∑–∞–ø—É—Å–∫:
```bash
docker-compose logs app | grep -i "cache\|cached"
```

–î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∑–∞–ø–∏—Å—å –æ **cache hit** –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞ (–ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å <100 –º—Å –≤–º–µ—Å—Ç–æ 3-8 —Å–µ–∫).

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ fallback –Ω–∞ Google Translate

–í—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç–µ Gemini API:

```bash
# –í .env —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–µ–≤–µ—Ä–Ω—ã–π –∫–ª—é—á
GEMINI_API_KEY=invalid_key

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
docker-compose restart app

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç
python scripts/run_integration_tests.py --test INT-001
```

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
```bash
docker-compose logs app | grep -i "fallback\|google"
```

–î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∑–∞–ø–∏—Å—å –æ **fallback to Google Translate**.

**–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å:**
```bash
# –í–µ—Ä–Ω—É—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–ª—é—á –≤ .env
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
docker-compose restart app
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

–û—Ç–ø—Ä–∞–≤—å—Ç–µ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π —Å–∏–≥–Ω–∞–ª:

```bash
# –°–æ–∑–¥–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª
cat > /tmp/invalid_test.json << 'EOF'
{
  "test_cases": [
    {
      "test_id": "INT-999",
      "name": "Invalid signal",
      "message_text": "Some random text without #–∏–¥–µ—è tag",
      "has_image": false,
      "wait_seconds": 5
    }
  ]
}
EOF

# –û—Ç–ø—Ä–∞–≤–∏—Ç—å (—Ç—Ä–µ–±—É–µ—Ç –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å–∫—Ä–∏–ø—Ç–∞ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥—Ä—É–≥–æ–≥–æ JSON)
# –ò–ª–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤—Ä—É—á–Ω—É—é –≤ SOURCE_GROUP
```

–ë–æ—Ç –¥–æ–ª–∂–µ–Ω **–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å** —Å–æ–æ–±—â–µ–Ω–∏–µ (–Ω–µ—Ç —Ç–µ–≥–∞ `#–ò–¥–µ—è`).

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –Ω–∞–≥—Ä—É–∑–∫–µ

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π:

```bash
python scripts/run_integration_tests.py --all --delay 5
```

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
- –í—Å–µ –ª–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã
- –ù–µ—Ç –ª–∏ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
- –ù–µ—Ç –ª–∏ –æ—à–∏–±–æ–∫ rate limiting

---

## –û—á–∏—Å—Ç–∫–∞ –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 1. –£–¥–∞–ª–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

**–ò–∑ SOURCE_GROUP:**
- –û—Ç–∫—Ä–æ–π—Ç–µ SOURCE_GROUP —á–µ—Ä–µ–∑ Reader –∞–∫–∫–∞—É–Ω—Ç
- –£–¥–∞–ª–∏—Ç–µ 5 —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤—Ä—É—á–Ω—É—é

**–ò–∑ TARGET_GROUP:**
- –û—Ç–∫—Ä–æ–π—Ç–µ TARGET_GROUP —á–µ—Ä–µ–∑ Publisher –∞–∫–∫–∞—É–Ω—Ç
- –£–¥–∞–ª–∏—Ç–µ 5 –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤—Ä—É—á–Ω—É—é

### 2. –û—á–∏—Å—Ç–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ PostgreSQL
docker-compose exec db psql -U postgres signal_bot

# –£–¥–∞–ª–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏
DELETE FROM signal_updates WHERE source_update_id BETWEEN 54000 AND 55000;
DELETE FROM signals WHERE source_message_id BETWEEN 54000 AND 55000;

# –í—ã—Ö–æ–¥
\q
```

### 3. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Docker-—Å–µ—Ä–≤–∏—Å—ã

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ)
docker-compose stop

# –ò–õ–ò –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–∏—Ç—å (–≤–∫–ª—é—á–∞—è volumes)
docker-compose down -v
```

**–í–ù–ò–ú–ê–ù–ò–ï:** `docker-compose down -v` —É–¥–∞–ª–∏—Ç **–≤—Å–µ –¥–∞–Ω–Ω—ã–µ** –≤ PostgreSQL –∏ Redis!

---

## –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (CI/CD)

### GitHub Actions Workflow

–°–æ–∑–¥–∞–π—Ç–µ `.github/workflows/integration-tests.yml`:

```yaml
name: Integration Tests

on:
  push:
    branches: [main, dev]
  pull_request:
    branches: [main]

jobs:
  integration-test:
    runs-on: ubuntu-latest

    services:
      postgres:
        image: postgres:15-alpine
        env:
          POSTGRES_DB: signal_bot
          POSTGRES_USER: postgres
          POSTGRES_PASSWORD: test_password
        options: >-
          --health-cmd pg_isready
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
        ports:
          - 5432:5432

      redis:
        image: redis:7-alpine
        options: >-
          --health-cmd "redis-cli ping"
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
        ports:
          - 6379:6379

    steps:
      - uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      - name: Install dependencies
        run: |
          pip install -r requirements.txt

      - name: Generate mock images
        run: |
          python scripts/generate_mock_images.py

      - name: Run integration tests (dry-run)
        env:
          READER_API_ID: ${{ secrets.READER_API_ID }}
          READER_API_HASH: ${{ secrets.READER_API_HASH }}
          READER_PHONE: ${{ secrets.READER_PHONE }}
          READER_SESSION_STRING: ${{ secrets.READER_SESSION_STRING }}
          SOURCE_GROUP_ID: ${{ secrets.SOURCE_GROUP_ID }}
        run: |
          python scripts/run_integration_tests.py --all --dry-run

      - name: Verify test data format
        run: |
          python -c "import json; json.load(open('tests/data/integration_test_signals.json'))"
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –†–µ–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ (–±–µ–∑ `--dry-run`) —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ Telegram API, —á—Ç–æ —Å–ª–æ–∂–Ω–æ –≤ CI/CD. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ dry-run –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

### –°–≤—è–∑–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [docs/AUTHENTICATION.md](AUTHENTICATION.md) - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ Telegram –∞–∫–∫–∞—É–Ω—Ç–æ–≤
- [README.md](../README.md) - –û–±—â–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
- [docs/architecture.md](architecture.md) - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã
- [docs/api.md](api.md) - API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# Docker
docker-compose ps               # –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose logs -f app      # –õ–æ–≥–∏ –±–æ—Ç–∞
docker-compose restart app      # –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞
docker-compose down -v          # –£–¥–∞–ª–∏—Ç—å –≤—Å–µ (–≤–∫–ª—é—á–∞—è volumes)

# PostgreSQL
docker-compose exec db psql -U postgres signal_bot
\dt                             # –°–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü
\d signals                      # –°—Ö–µ–º–∞ —Ç–∞–±–ª–∏—Ü—ã signals
SELECT COUNT(*) FROM signals;   # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–≥–Ω–∞–ª–æ–≤

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
python scripts/run_integration_tests.py --list
python scripts/run_integration_tests.py --all --dry-run
python scripts/run_integration_tests.py --test INT-001
python scripts/verify_target_group.py --limit 20
```

### –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- **Telegram API**: [https://my.telegram.org/apps](https://my.telegram.org/apps)
- **Gemini API**: [https://makersuite.google.com/app/apikey](https://makersuite.google.com/app/apikey)
- **Telethon Docs**: [https://docs.telethon.dev/](https://docs.telethon.dev/)
- **Docker Compose Docs**: [https://docs.docker.com/compose/](https://docs.docker.com/compose/)

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —ç—Ç–∞–ø –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞ –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö. –°–ª–µ–¥—É—è —ç—Ç–æ–º—É —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤—É, –≤—ã —Å–º–æ–∂–µ—Ç–µ:

1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤
3. –í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
4. –î–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ —É—Å—Ç—Ä–∞–Ω—è—Ç—å –ø—Ä–æ–±–ª–µ–º—ã

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- –ó–∞–ø—É—Å–∫–∞–π—Ç–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –æ—à–∏–±–æ–∫
- –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–∏–≥–Ω–∞–ª–æ–≤
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∫–≤–æ—Ç—É Gemini API

**–£—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è!** üöÄ
